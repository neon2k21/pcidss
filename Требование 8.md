#   Требование 8: Идентификация пользователей и проверка подлинности доступа к компонентам системы

Два фундаментальных принципа идентификации и аутентификации пользователей заключаются в том, чтобы 1) установить личность физического лица или процесса в компьютерной системе и 2) доказать или подтвердить, что пользователь, связанный с идентификацией, является тем, за кого себя выдает.
Идентификация человека или процесса в компьютерной системе осуществляется путем сопоставления идентификатора с человеком или процессом с помощью идентификатора, такого как идентификатор пользователя, системы или приложения. Эти идентификаторы (также называемые “учетными записями”) в основном устанавливают личность человека или процесса, присваивая каждому человеку или процессу уникальную идентификацию, чтобы отличать одного пользователя или процесс от другого. Когда каждый пользователь или процесс может быть однозначно идентифицирован, это гарантирует подотчетность за действия, выполняемые этим идентификатором. Когда такая подотчетность существует, предпринятые действия могут быть прослежены до известных и авторизованных пользователей и процессов.
Элемент, используемый для подтверждения или проверки подлинности, известен как фактор аутентификации. Факторы аутентификации - это 1) что-то, что вы знаете, например, пароль или кодовая фраза, 2) что-то, что у вас есть, например, токен-устройство или смарт-карта, или 3) что-то, чем вы являетесь, например, биометрический элемент.
Идентификатор и фактор аутентификации вместе считаются учетными данными для аутентификации и используются для получения доступа к правам и привилегиям, связанным с учетными записями пользователя, приложения, системы или службы.
Эти требования к идентификации и аутентификации основаны на общепринятых в отрасли принципах безопасности и передовых методах поддержки платежной экосистемы. Специальная публикация NIST 800-63 "Руководство по цифровой идентификации" содержит дополнительную информацию о приемлемых рамках для цифровой идентификации и факторах аутентификации. Важно отметить, что Руководство NIST по цифровой идентификации предназначено для федеральных агентств США и должно рассматриваться полностью. Ожидается, что многие концепции и подходы, определенные в настоящих руководящих принципах, будут работать друг с другом, а не как отдельные параметры.
Примечание: Если в требовании не указано иное, эти требования применяются ко всем учетным записям во всех компонентах системы, если это специально не указано в отдельном требовании, включая, но не ограничиваясь:
Счета в торговых точках
Учетные записи с административными возможностями
Учетные записи системы и приложений
Все учетные записи, используемые для просмотра или доступа к данным о держателях карт или для доступа к системам с данными о держателях карт.
Сюда входят учетные записи, используемые сотрудниками, подрядчиками, консультантами, внутренними и внешними поставщиками и другими третьими сторонами (например, для предоставления услуг поддержки или технического обслуживания). Определенные требования не предназначены для применения к учетным записям пользователей, которые имеют доступ только к одному номеру карты одновременно для облегчения одной транзакции (например, идентификаторы, используемые кассирами в терминалах торговых точек). Когда элементы не применяются, они отмечаются непосредственно в конкретном требовании.
##  8.1 Определены и понятны процессы и механизмы идентификации пользователей и аутентификации доступа к компонентам системы.
### 8.1.1   Все политики безопасности и операционные процедуры, указанные в Требовании 8, должны быть:
*   Документированы.
*   Актуальны. 
*   Используются.
*   Известны всем затронутым сторонам.

Изучите документацию и опросите персонал, чтобы убедиться, что политика безопасности и операционные процедуры, определенные в Требовании 8, управляются в соответствии со всеми элементами, указанными в этом требовании.

### 8.1.2   Роли и обязанности для выполнения действий, указанных в Требовании 8, задокументированы, распределены и поняты.

Изучите документацию, чтобы убедиться, что описания ролей и обязанностей для выполнения действий в Требовании 8 задокументированы и распределены.

Провести собеседование с персоналом, ответственным за выполнение действий, указанных в Требовании 8, чтобы убедиться, что роли и обязанности распределены в соответствии с документацией и поняты

##  8.2 Идентификация пользователя и связанные с ней учетные записи пользователей и администраторов строго контролируются на протяжении всего жизненного цикла учетной записи.
### 8.2.1   Всем пользователям присваивается уникальный идентификатор, прежде чем будет разрешен доступ к компонентам системы или данным о держателях карт.

Провести собеседование с ответственным персоналом, чтобы убедиться, что всем пользователям присвоен уникальный идентификатор для доступа к компонентам системы и данным о держателях карт.

Изучите журналы аудита и другие доказательства, чтобы убедиться, что доступ к компонентам системы и данным о держателях карт может быть однозначно идентифицирован и связан с отдельными лицами.

### 8.2.2   Групповые, общие или общие учетные записи или другие общие учетные данные для проверки подлинности используются только при необходимости в исключительных случаях и управляются следующим образом:
*   Использование учетной записи запрещено, за исключением случаев, когда это необходимо в исключительных обстоятельствах.
*   Использование ограничено временем, необходимым для исключительных обстоятельств.
*   Бизнес-обоснование использования задокументировано.
*   Использование явно одобрено руководством.
*   Индивидуальная идентификация пользователя подтверждается до предоставления доступа к учетной записи.
*   Каждое предпринятое действие относится к отдельному пользователю.

Изучите списки учетных записей пользователей в системных компонентах и соответствующую документацию, чтобы убедиться, что общие учетные данные для аутентификации используются только при необходимости, в исключительных случаях и управляются в соответствии со всеми элементами, указанными в этом требовании.

Изучите политики и процедуры аутентификации, чтобы убедиться, что процессы определены для общих учетных данных аутентификации таким образом, что они используются только при необходимости, в исключительных случаях, и управляются в соответствии со всеми элементами, указанными в этом требовании.

Опросите системных администраторов, чтобы убедиться, что общие учетные данные для аутентификации используются только при необходимости, в порядке исключения, и управляются в соответствии со всеми элементами, указанными в этом требовании.

### 8.2.3   Дополнительное требование только для поставщиков услуг: Поставщики услуг с удаленным доступом к помещениям клиентов используют уникальные факторы аутентификации для каждого помещения клиента.


Дополнительная процедура тестирования только для оценки поставщиков услуг: Изучите политики и процедуры аутентификации и опросите персонал, чтобы убедиться, что поставщики услуг с удаленным доступом к помещениям клиентов используют уникальные факторы аутентификации для удаленного доступа к помещениям каждого клиента.

### 8.2.4   Добавление, удаление и изменение идентификаторов пользователей, факторов аутентификации и других объектов идентификаторов управляются следующим образом:
*   Авторизован с соответствующим утверждением.
*   Реализовано только с привилегиями, указанными в документированном утверждении.

Изучите документированные авторизации на различных этапах жизненного цикла учетной записи (добавления, изменения и удаления) и изучите системные настройки, чтобы убедиться, что управление активностью осуществлялось в соответствии со всеми элементами, указанными в этом требовании.

### 8.2.5   Доступ для прекращенных пользователей немедленно аннулируется.

Изучите источники информации о завершенных пользователях и просмотрите текущие списки доступа пользователей — как для локального, так и для удаленного доступа — чтобы убедиться, что идентификаторы завершенных пользователей были деактивированы или удалены из списков доступа.

Опросите ответственный персонал, чтобы убедиться, что все физические факторы аутентификации — такие как смарт—карты, токены и т.д. - были возвращены или деактивированы для прекращенных пользователей.

### 8.2.6   Неактивные учетные записи пользователей удаляются или отключаются в течение 90 дней бездействия.

Проверьте учетные записи пользователей и информацию о последнем входе в систему, а также опросите персонал, чтобы убедиться, что все неактивные учетные записи пользователей удалены или отключены в течение 90 дней бездействия.

### 8.2.7   Учетные записи, используемые третьими лицами для доступа, поддержки или обслуживания компонентов системы через удаленный доступ, управляются следующим образом:
*   Включается только в течение необходимого периода времени и отключается, когда не используется.
*   Использование отслеживается на предмет непредвиденных действий.

Опросите персонал, изучите документацию по управлению учетными записями и изучите доказательства, чтобы убедиться, что учетные записи, используемые третьими лицами для удаленного доступа, управляются в соответствии со всеми элементами, указанными в этом требовании.

### 8.2.8   Если сеанс пользователя простаивает более 15 минут, пользователю необходимо повторно пройти аутентификацию, чтобы повторно активировать терминал или сеанс.

Проверьте параметры конфигурации системы, чтобы убедиться, что функции тайм-аута ожидания системы/сеанса для пользовательских сеансов установлены на 15 минут или меньше.

##  8.3 Установлена и управляется строгая проверка подлинности для пользователей и администраторов
### 8.3.1   Весь пользовательский доступ к системным компонентам для пользователей и администраторов проверяется с помощью по крайней мере одного из следующих факторов аутентификации:
*   Что-то, что вы знаете, например, пароль или кодовую фразу.
*   Что-то, что у вас есть, например, токен-устройство или смарт-карта.
*   Что-то, чем вы являетесь, например, биометрический элемент.

Изучить документацию, описывающую фактор (ы) аутентификации, используемый(ые) для проверки того, что доступ пользователя к компонентам системы аутентифицируется по крайней мере с помощью одного фактора аутентификации, указанного в этом требовании.

Для каждого типа фактора аутентификации, используемого с каждым типом системного компонента, соблюдайте аутентификацию, чтобы убедиться, что аутентификация работает в соответствии с задокументированным фактором (факторами) аутентификации.

### 8.3.2   Надежная криптография используется для того, чтобы сделать все факторы аутентификации нечитаемыми во время передачи и хранения во всех компонентах системы.

Изучите документацию поставщика и параметры конфигурации системы, чтобы убедиться, что факторы аутентификации становятся нечитаемыми с помощью надежной криптографии во время передачи и хранения.

Проверьте хранилища факторов аутентификации, чтобы убедиться, что они нечитаемы во время хранения. 8.3.2.c Проверяйте передачи данных, чтобы убедиться, что факторы аутентификации нечитаемы во время передачи

###   8.3.3   Идентификация пользователя проверяется перед изменением любого фактора аутентификации.

Изучите процедуры изменения факторов аутентификации и понаблюдайте за сотрудниками службы безопасности, чтобы убедиться, что, когда пользователь запрашивает изменение фактора аутентификации, личность пользователя проверяется до изменения фактора аутентификации.

### 8.3.4   Недопустимые попытки аутентификации ограничены:
*   Блокировкой идентификатора пользователя не более чем после 10 попыток.
*   Установка продолжительности блокировки минимум на 30 минут или до тех пор, пока не будет подтверждена личность пользователя.

Проверьте параметры конфигурации системы, чтобы убедиться, что параметры аутентификации установлены так, чтобы требовать блокировки учетных записей пользователей не более чем после 10 неудачных попыток входа в систему.

Проверьте настройки конфигурации системы, чтобы убедиться, что параметры пароля установлены так, чтобы после блокировки учетной записи пользователя она оставалась заблокированной минимум на 30 минут или до подтверждения личности пользователя.

### 8.3.5   Если пароли/парольные фразы используются в качестве факторов аутентификации в соответствии с требованием 8.3.1, они устанавливаются и сбрасываются для каждого пользователя следующим образом:
*   Устанавливается на уникальное значение при первом использовании и при сбросе.
*   Принудительно заменяется сразу после первого использования.

Изучите процедуры установки и сброса паролей/парольных фраз (если они используются в качестве факторов аутентификации в соответствии с требованием 8.3.1) и понаблюдайте за персоналом службы безопасности, чтобы убедиться, что пароли/парольные фразы установлены и сброшены в соответствии со всеми элементами, указанными в этом требовании.

### 8.3.6   Если пароли/парольные фразы используются в качестве факторов аутентификации для удовлетворения требования 8.3.1, они соответствуют следующему минимальному уровню сложности:
*   Минимальная длина 12 символов (или, если система не поддерживает 12 символов, минимальная длина восемь символов).
*   Содержат как цифровые, так и буквенные символы.

Проверьте параметры конфигурации системы, чтобы убедиться, что параметры сложности пароля пользователя/парольной фразы установлены в соответствии со всеми элементами, указанными в этом требовании.

### 8.3.7   Физическим лицам не разрешается вводить новый пароль/парольную фразу, которая совпадает с любым из последних четырех использованных паролей/парольных фраз.

Проверьте параметры конфигурации системы, чтобы убедиться, что параметры пароля установлены так, чтобы новые пароли/парольные фразы не могли совпадать с четырьмя ранее использованными паролями/парольными фразами.

### 8.3.8   Политики и процедуры аутентификации документируются и доводятся до сведения всех пользователей, включая:
*   Руководство по выбору надежных факторов аутентификации.
*   Руководство по тому, как пользователи должны защищать свои факторы аутентификации.
*   Инструкции не использовать повторно ранее использованные пароли / парольные фразы.
*   Инструкции по смене паролей/парольных фраз, если есть какие-либо подозрения или сведения о том, что пароль/парольные фразы были скомпрометированы, и как сообщить об инциденте.

Изучить процедуры и опросить персонал, чтобы убедиться, что политики и процедуры аутентификации распространены среди всех пользователей.

Просмотрите политики и процедуры аутентификации, которые распространяются среди пользователей, и убедитесь, что они включают элементы, указанные в этом требовании.

Опрашивать пользователей, чтобы убедиться, что они знакомы с политиками и процедурами аутентификации.

### 8.3.9   Если пароли / парольные фразы используются в качестве единственного фактора аутентификации для доступа пользователя (т.е. в любой реализации однофакторной аутентификации), то либо:
*   Пароли/парольные фразы меняются не реже одного раза в 90 дней,  ИЛИ
*   Состояние безопасности учетных записей динамически анализируется, и соответственно автоматически определяется доступ к ресурсам в режиме реального времени.

Если пароли/парольные фразы используются в качестве единственного фактора аутентификации для доступа пользователя, проверьте параметры конфигурации системы, чтобы убедиться, что управление паролями/парольными фразами осуществляется в соответствии с ОДНИМ из элементов, указанных в этом требовании.

### 8.3.10  Дополнительное требование только для поставщиков услуг: Если пароли/парольные фразы используются в качестве единственного фактора аутентификации для доступа пользователя клиента к данным держателя карты (т.е. в любой реализации однофакторной аутентификации), то пользователям клиентов предоставляются рекомендации, в том числе:
*   Рекомендации для клиентов по периодической смене своих пользовательских паролей/парольных фраз.
*   Указания относительно того, когда и при каких обстоятельствах следует менять пароли/парольные фразы.

Дополнительная процедура тестирования только для оценки поставщика услуг: Если пароли / парольные фразы используются в качестве единственного фактора аутентификации для доступа пользователя клиента к данным о держателях карт, изучите руководство, предоставленное пользователям клиента, чтобы убедиться, что руководство включает все элементы, указанные в этом требовании.

####    8.3.10.1    Дополнительное требование только для поставщиков услуг: Если пароли / парольные фразы используются в качестве единственного фактора аутентификации для доступа пользователя клиента (т.е. в любой реализации однофакторной аутентификации), то либо:
*   Пароли/парольные фразы меняются не реже одного раза в 90 дней, ИЛИ
*   Состояние безопасности учетных записей динамически анализируется, и соответственно автоматически определяется доступ к ресурсам в режиме реального времени.

Дополнительная процедура тестирования только для оценки поставщика услуг: Если пароли/парольные фразы используются в качестве единственного фактора аутентификации для доступа пользователя клиента, проверьте параметры конфигурации системы, чтобы убедиться, что управление паролями/парольными фразами осуществляется в соответствии с ОДНИМ из элементов, указанных в этом требовании.

>   Дополнительная информация:
    Для получения информации об использовании динамического анализа для управления доступом пользователей к ресурсам обратитесь к NIST SP 800-207 Архитектура нулевого доверия.

####    8.3.11  Где используются такие факторы аутентификации, как физические или логические маркеры безопасности, смарт-карты или сертификаты:
*   Факторы назначаются отдельному пользователю и не распределяются между несколькими пользователями.
*   Физические и / или логические элементы управления гарантируют, что только предполагаемый пользователь может использовать этот фактор для получения доступа.

Изучите политики и процедуры аутентификации, чтобы убедиться, что процедуры для использования факторов аутентификации, таких как физические маркеры безопасности, смарт-карты и сертификаты, определены и включают все элементы, указанные в этом требовании.

Опросите сотрудников службы безопасности, чтобы убедиться, что факторы аутентификации назначены отдельному пользователю, а не распределены между несколькими пользователями.

Изучите параметры конфигурации системы и / или соблюдайте физические средства управления, если применимо, чтобы убедиться, что средства управления реализованы, чтобы гарантировать, что только предполагаемый пользователь может использовать этот фактор для получения доступа.

##  8.4 Для обеспечения безопасного доступа к CDE реализована многофакторная аутентификация (MFA).
### 8.4.1   MFA реализован для всего неконсольного доступа к CDE для персонала с административным доступом.

проверка сетевых и/или системных конфигураций для проверки MFA требуется для всех неконсолей в CDE для персонала с административным доступом.

Наблюдайте за тем, как персонал администратора входит в CDE, и убедитесь, что требуется MFA.

### 8.4.2   MFA реализован для всех видов доступа к CDE.

Изучите сетевые и / или системные конфигурации, чтобы убедиться, что MFA реализован для любого доступа к CDE. 8.4.2.b Наблюдайте за персоналом, входящим в CDE, и изучайте доказательства, чтобы убедиться, что MFA требуется.

### 8.4.3   MFA реализуется для всего удаленного доступа к сети, исходящего из-за пределов сети организации, который может получить доступ к CDE или повлиять на него следующим образом:
*   Весь удаленный доступ для всего персонала, как пользователей, так и администраторов, исходящий из-за пределов сети организации.
*   Весь удаленный доступ третьих сторон и поставщиков.

Требуется проверка сетевых и/или системных конфигураций серверов и систем удаленного доступа для проверки MFA в соответствии со всеми элементами, указанными в этом требовании.

Наблюдайте за персоналом (например, пользователями и администраторами), удаленно подключающимся к сети, и убедитесь, что требуется многофакторная аутентификация.

##  8.5 Системы многофакторной аутентификации (MFA) настроены для предотвращения неправильного использования
### 8.5.1   Системы MFA реализуются следующим образом:
*   Система MFA не подвержена повторным атакам.
*   Системы MFA не могут быть обойдены никакими пользователями, включая административных пользователей, если это специально не задокументировано и не разрешено руководством в порядке исключения в течение ограниченного периода времени.
*   Используются по меньшей мере два различных типа факторов аутентификации.
*   Для предоставления доступа требуется успешное выполнение всех факторов аутентификации.

Изучите системную документацию поставщика, чтобы убедиться, что система MFA не подвержена повторным атакам.

Изучите системные конфигурации для реализации MFA, чтобы убедиться, что она настроена в соответствии со всеми элементами, указанными в этом требовании.

Проводить собеседования с ответственным персоналом и наблюдать за процессами, чтобы убедиться, что любые запросы на обход MFA специально документируются и разрешаются руководством в порядке исключения в течение ограниченного периода времени.

Наблюдайте за персоналом, входящим в системные компоненты в CDE, чтобы убедиться, что доступ предоставляется только после успешного выполнения всех факторов аутентификации.

Наблюдайте за персоналом, подключающимся удаленно из-за пределов сети организации, чтобы убедиться, что доступ предоставляется только после успешного выполнения всех факторов аутентификации.

##  8.6 Использование учетных записей приложений и системы и связанных с ними факторов аутентификации строго контролируется
### 8.6.1   Если учетные записи, используемые системами или приложениями, могут использоваться для интерактивного входа в систему, управление ими осуществляется следующим образом:
*   Интерактивное использование запрещено, за исключением случаев, когда это необходимо в исключительных обстоятельствах.
*   Интерактивное использование ограничено временем, необходимым для исключительных обстоятельств.
*   Бизнес-обоснование интерактивного использования задокументировано.
*   Интерактивное использование явно одобрено руководством.
*   Индивидуальная идентификация пользователя подтверждается до предоставления доступа к учетной записи.
*   Каждое предпринятое действие относится к отдельному пользователю.

Изучите учетные записи приложений и систем, которые можно использовать в интерактивном режиме, и опросите административный персонал, чтобы убедиться, что управление учетными записями приложений и систем осуществляется в соответствии со всеми элементами, указанными в этом требовании.

### 8.6.2   Пароли/парольные фразы для любых учетных записей приложений и систем, которые можно использовать для интерактивного входа в систему, не жестко закодированы в скриптах, файлах конфигурации/свойств или в специально разработанном и настраиваемом исходном коде.

Провести собеседование с персоналом и изучить процедуры разработки системы, чтобы убедиться, что процессы определены для учетных записей приложений и системы, которые могут использоваться для интерактивного входа в систему, указав, что пароли / парольные фразы не жестко закодированы в сценариях, файлах конфигурации / свойств или заказном и пользовательском исходном коде.

Изучите сценарии, файлы конфигурации/свойств, а также индивидуальный и пользовательский исходный код для учетных записей приложений и систем, которые могут использоваться для интерактивного входа в систему, чтобы убедиться, что пароли / парольные фразы для этих учетных записей отсутствуют.

### 8.6.3   Пароли / парольные фразы для любых приложений и системных учетных записей защищены от неправильного использования следующим образом:
*   Пароли/парольные фразы меняются периодически (с частотой, определенной в целевом анализе рисков организации, который выполняется в соответствии со всеми элементами, указанными в Требовании 12.3.1) и при подозрении или подтверждении компрометации.
*   Пароли/парольные фразы создаются с достаточной сложностью, соответствующей тому, как часто объект меняет пароли/парольные фразы.

Изучите политики и процедуры, чтобы убедиться, что определены процедуры для защиты паролей/парольных фраз для учетных записей приложений или системы от неправильного использования в соответствии со всеми элементами, указанными в этом требовании.

Изучите целевой анализ рисков организации на предмет частоты и сложности изменений паролей/парольных фраз, используемых для интерактивного входа в учетные записи приложений и системы, чтобы убедиться, что анализ рисков был выполнен в соответствии со всеми элементами, указанными в Требовании 12.3.1, и адреса:
*   Частота, определенная для периодических изменений паролей/парольных фраз приложений и системы.
*   Сложность, определенная для паролей/парольных фраз, и соответствие сложности по отношению к частоте изменений.

Опросите ответственный персонал и изучите параметры конфигурации системы, чтобы убедиться, что пароли / парольные фразы для любых приложений и системных учетных записей, которые могут использоваться для интерактивного входа в систему, защищены от неправильного использования в соответствии со всеми элементами, указанными в этом требовании.