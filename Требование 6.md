#   Требование 6: Разработка и поддержка Защищенных Систем и программного обеспечения

Злоумышленники могут использовать уязвимости в системе безопасности для получения привилегированного доступа к системам. Многие из этих уязвимостей устраняются с помощью исправлений безопасности, предоставляемых поставщиком, которые должны быть установлены организациями, управляющими системами. Все компоненты системы должны иметь все соответствующие исправления программного обеспечения для защиты от использования и компрометации данных учетной записи злоумышленниками и вредоносным программным обеспечением.
Соответствующие исправления программного обеспечения - это те исправления, которые были оценены и протестированы в достаточной степени, чтобы определить, что исправления не конфликтуют с существующими конфигурациями безопасности. Для программного обеспечения, изготовленного на заказ и изготовленного на заказ, можно избежать многочисленных уязвимостей, применяя процессы жизненного цикла программного обеспечения (SLC) и методы безопасного кодирования.
Хранилища кода, в которых хранится код приложения, системные конфигурации или другие данные конфигурации, которые могут повлиять на безопасность данных учетной записи или CDE, подпадают под оценку PCI DSS.
См. Взаимосвязь между стандартами программного обеспечения PCI DSS и PCI SSC на стр. 7 для получения информации об использовании программного обеспечения, прошедшего проверку PCI SSC, и о поставщиках программного обеспечения, а также о том, как использование стандартов программного обеспечения PCI SSC может помочь в выполнении требований Требования 6.

##  6.1 Определены и понятны процессы и механизмы разработки и поддержки защищенных систем и программного обеспечения.
### 6.1.1   Все политики безопасности и операционные процедуры, указанные в Требовании 6:
*   Документированы.
*   Актуальны.
*   Используются.
*   Известны всем затронутым сторонам.

Изучите документацию и опросите персонал, чтобы убедиться, что политика безопасности и операционные процедуры, указанные в Требовании 6, управляются в соответствии со всеми элементами, указанными в этом требовании.

### 6.1.2   Роли и обязанности для выполнения действий, указанных в Требовании 6, задокументированы, распределены и поняты.

Изучите документацию, чтобы убедиться, что описания ролей и обязанностей для выполнения действий в Требовании 6 задокументированы и распределены. 

Провести собеседование с персоналом, ответственным за выполнение действий, указанных в Требовании 6, чтобы убедиться, что роли и обязанности распределены в соответствии с документацией и поняты.

##  6.2 Программное обеспечение на заказ и на заказ разрабатывается надежно.
### 6.2.1   Программное обеспечение на заказ и на заказ разрабатывается надежно, следующим образом:
*   На основе отраслевых стандартов и/или лучших практик безопасной разработки.
*   В соответствии с PCI DSS (например, безопасная аутентификация и ведение журнала).
*   Учет вопросов информационной безопасности на каждом этапе жизненного цикла разработки программного обеспечения.

Изучите документированные процедуры разработки программного обеспечения, чтобы убедиться, что определены процессы, включающие все элементы, указанные в этом требовании.

### 6.2.2   Персонал по разработке программного обеспечения, работающий над индивидуальным и заказным программным обеспечением, проходит обучение **не реже одного раза в 12 месяцев** следующим образом:
*   О безопасности программного обеспечения, относящегося к их должностным функциям и языкам разработки.
*   Включая безопасную разработку программного обеспечения и безопасные методы кодирования
*   В том числе, если используются инструменты тестирования безопасности, как использовать инструменты для обнаружения уязвимостей в программном обеспечении.

Изучить процедуры разработки программного обеспечения, чтобы убедиться, что определены процессы для обучения персонала по разработке программного обеспечения, разрабатывающего индивидуальное и индивидуальное программное обеспечение, включающее все элементы, указанные в этом требовании.

Изучите записи об обучении и опросите персонал, чтобы убедиться, что персонал по разработке программного обеспечения, работающий над индивидуальным и заказным программным обеспечением, прошел обучение по безопасности программного обеспечения, соответствующее их должностным функциям и языкам разработки, в соответствии со всеми элементами, указанными в этом требовании.

### 6.2.3   Разработанное на заказ и заказное программное обеспечение проверяется перед выпуском в производство или для клиентов, чтобы выявить и исправить потенциальные уязвимости в коде следующим образом:
*   Проверка кода гарантирует, что код разрабатывается в соответствии с рекомендациями по безопасному кодированию.
*   Анализ кода направлен на выявление как существующих, так и новых уязвимостей программного обеспечения.
*   Соответствующие исправления вносятся до выпуска

Изучить документированные процедуры разработки программного обеспечения и провести собеседование с ответственным персоналом, чтобы убедиться, что определены процессы, требующие проверки всего программного обеспечения, изготовленного на заказ и изготовленного на заказ, в соответствии со всеми элементами, указанными в этом требовании.

Изучить доказательства изменений в заказном и заказном программном обеспечении, чтобы убедиться, что изменения в коде были рассмотрены в соответствии со всеми элементами, указанными в этом требовании.

####    6.2.3.1 Если проверка кода вручную выполняется для программного обеспечения, изготовленного на заказ, перед выпуском в производство, изменения кода:
*   Проверено лицами, не являющимися автором исходного кода, и которые хорошо осведомлены о методах проверки кода и методах безопасного кодирования.
*   Рассмотрено и одобрено руководством перед выпуском.

Если для программного обеспечения, изготовленного на заказ и изготовленного на заказ, выполняются проверки кода вручную перед выпуском в производство, изучите документированные процедуры разработки программного обеспечения и опросите ответственный персонал, чтобы убедиться, что процессы определены для проведения проверок кода вручную в соответствии со всеми элементами, указанными в этом требовании.

Изучить доказательства изменений в программном обеспечении, изготовленном на заказ, и провести собеседование с персоналом, чтобы убедиться, что проверка кода вручную проводилась в соответствии со всеми элементами, указанными в этом требовании.

### 6.2.4   Методы разработки программного обеспечения или другие методы определяются и используются персоналом по разработке программного обеспечения для предотвращения или смягчения распространенных программных атак и связанных с ними уязвимостей в программном обеспечении на заказ и на заказ, включая, но не ограничиваясь следующим:
*   Инъекционные атаки, включая SQL, LDAP, XPath или другие ошибки типа команд, параметров, объектов, ошибок или ошибок типа инъекций.
*   Атаки на данные и структуры данных, включая попытки манипулировать буферами, указателями, входными данными или общими данными.
*   Атаки на использование криптографии, включая попытки использовать слабые, небезопасные или неподходящие криптографические реализации, алгоритмы, наборы шифров или режимы работы.
*   Атаки на бизнес-логику, включая попытки злоупотребления или обхода функций и функциональных возможностей приложения посредством манипулирования API, протоколами и каналами связи, клиентскими функциями или другими системными/прикладными функциями и ресурсами. Это включает в себя межсайтовые скрипты (XSS) и подделку межсайтовых запросов (CSRF).
*   Атаки на механизмы контроля доступа, включая попытки обойти или злоупотребить механизмами идентификации, аутентификации или авторизации, или попытки использовать слабые места в реализации таких механизмов.
*   Атаки с использованием любых уязвимостей “высокого риска”, выявленных в процессе идентификации уязвимостей, как определено в требовании 6.3.1.

Изучить документированные процедуры и провести собеседование с ответственным персоналом по разработке программного обеспечения, чтобы убедиться, что методы разработки программного обеспечения или другие методы определены и используются разработчиками индивидуального и заказного программного обеспечения для предотвращения или смягчения всех распространенных программных атак, как указано в этом требовании.

##  6.3 Выявляются и устраняются уязвимости в системе безопасности.
### 6.3.1   Уязвимости в системе безопасности выявляются и устраняются следующим образом:
*   Новые уязвимости в системе безопасности выявляются с использованием признанных в отрасли источников информации об уязвимостях системы безопасности, включая оповещения от международных и национальных групп реагирования на компьютерные чрезвычайные ситуации (CERT).
*   Уязвимостям присваивается рейтинг рисков на основе лучших отраслевых практик и учета потенциального воздействия.
*   Рейтинги рисков определяют, как минимум, все уязвимости, которые считаются высокорискованными или критичными для окружающей среды.
*   Рассматриваются уязвимости для индивидуального и пользовательского программного обеспечения, а также программного обеспечения сторонних производителей (например, операционных систем и баз данных).

Изучите политики и процедуры для выявления уязвимостей в системе безопасности и управления ими, чтобы убедиться, что процессы определены в соответствии со всеми элементами, указанными в этом требовании.

Опросите ответственный персонал, изучите документацию и проследите за процессами, чтобы убедиться, что уязвимости в системе безопасности выявлены и устранены в соответствии со всеми элементами, указанными в этом требовании.

### 6.3.2   Для облегчения управления уязвимостями и исправлениями ведется инвентаризация программного обеспечения, изготовленного на заказ, и программных компонентов сторонних производителей, включенных в программное обеспечение, изготовленное на заказ.

Изучите документацию и опросите персонал, чтобы убедиться, что ведется инвентаризация программного обеспечения, изготовленного на заказ, и программных компонентов сторонних производителей, включенных в программное обеспечение, изготовленное на заказ, и что инвентаризация используется для выявления и устранения уязвимостей.

Изучите документацию по программному обеспечению, в том числе для изготовленного на заказ и изготовленного на заказ программного обеспечения, которое объединяет сторонние программные компоненты, и сравните ее с описью, чтобы убедиться, что опись включает в себя изготовленное на заказ и изготовленное на заказ программное обеспечение и сторонние программные компоненты.

### 6.3.3   Все компоненты системы защищены от известных уязвимостей путем установки соответствующих исправлений/обновлений безопасности следующим образом:
*   Критические или высокозащищенные исправления/обновления (идентифицированные в соответствии с процессом ранжирования рисков в требовании 6.3.1) устанавливаются **в течение одного месяца после выпуска**.
*   Все другие применимые исправления/обновления безопасности устанавливаются **в течение соответствующего периода времени, определенного организацией (например, в течение трех месяцев после выпуска)**.

Изучить политики и процедуры для проверки того, определены ли процессы для устранения уязвимостей путем установки соответствующих исправлений/обновлений безопасности в соответствии со всеми элементами, указанными в этом требовании.

Изучите системные компоненты и связанное с ними программное обеспечение и сравните список установленных исправлений/обновлений безопасности с самой последней информацией об исправлениях/обновлениях безопасности, чтобы убедиться, что уязвимости устранены в соответствии со всеми элементами, указанными в этом требовании.

##  6.4 Общедоступные веб-приложения защищены от атак.
### 6.4.1   Для общедоступных веб-приложений новые угрозы и уязвимости устраняются на постоянной основе, и эти приложения защищены от известных атак следующим образом:
*   Проверка общедоступных веб-приложений с помощью ручных или автоматизированных инструментов или методов оценки безопасности уязвимостей приложений следующим образом:
    *   **Не реже одного раза в 12 месяцев и после значительных изменений**.
    *   Организацией, специализирующейся на безопасности приложений.
    *   Включая, как минимум, все распространенные программные атаки в требовании 6.2.4.
    *   Все уязвимости ранжируются в соответствии с требованием 6.3.1.
    *   Все уязвимости исправлены.
*   Заявка повторно оценивается после внесения исправлений ИЛИ
*   Установка автоматизированного технического решения (решений), которое постоянно обнаруживает и предотвращает веб-атаки следующим образом:
*   Устанавливается перед общедоступными веб-приложениями для обнаружения и предотвращения веб-атак.
*   Активно работает и обновляется по мере необходимости.
*   Создание журналов аудита.
*   Настроен либо на блокировку веб-атак, либо на генерацию предупреждения, которое немедленно проверяется.

Для общедоступных веб-приложений убедитесь, что используется один из требуемых методов следующим образом: 
*   Если используются ручные или автоматические инструменты или методы оценки безопасности уязвимостей, изучите документированные процессы, опросите персонал и изучите записи оценок безопасности приложений, чтобы убедиться, что общедоступные веб-приложения проверяются в соответствии со всеми элементами этого требования, специфичного для инструмента / метода. ИЛИ
*   Если установлено автоматизированное техническое решение (решения), которое постоянно обнаруживает и предотвращает веб-атаки, изучите параметры конфигурации системы и журналы аудита и опросите ответственный персонал, чтобы убедиться, что автоматизированное техническое решение (решения) установлено в соответствии со всеми элементами этого требования, специфичного для решения (решений).

### 6.4.2   Для общедоступных веб-приложений развертывается автоматизированное техническое решение, которое постоянно обнаруживает и предотвращает веб-атаки, по крайней мере, со следующими:
*   Устанавливается перед общедоступными веб-приложениями и настраивается для обнаружения и предотвращения веб-атак.
*   Активно работает и обновляется по мере необходимости.
*   Создание журналов аудита.
*   Настроен либо на блокировку веб-атак, либо на генерацию предупреждения, которое немедленно проверяется.

Для общедоступных веб-приложений изучите параметры конфигурации системы и журналы аудита, а также опросите ответственный персонал, чтобы убедиться, что автоматизированное техническое решение, которое обнаруживает и предотвращает веб-атаки, действует в соответствии со всеми элементами, указанными в этом требовании.

### 6.4.3   Все скрипты страницы оплаты, которые загружаются и выполняются в браузере пользователя, управляются следующим образом:
*   Реализован метод для подтверждения того, что каждый сценарий авторизован.
*   Реализован метод для обеспечения целостности каждого скрипта.
*   Ведется инвентаризация всех сценариев с письменным обоснованием того, почему каждый из них необходим

Изучить политики и процедуры, чтобы убедиться, что определены процессы для управления всеми скриптами платежных страниц, которые загружаются и выполняются в браузере потребителя, в соответствии со всеми элементами, указанными в этом требовании.

Опросите ответственный персонал и изучите инвентарные записи и системные конфигурации, чтобы убедиться, что все скрипты страницы оплаты, которые загружаются и выполняются в браузере потребителя, управляются в соответствии со всеми элементами, указанными в этом требовании.

##  6.5 Безопасное управление изменениями во всех компонентах системы
### 6.5.1   Изменения во всех компонентах системы в производственной среде вносятся в соответствии с установленными процедурами, которые включают:
*   Причина и описание изменения. 
*   Документирование воздействия на безопасность.
*   Документально подтвержденное одобрение изменений уполномоченными сторонами.
*   Тестирование, чтобы убедиться, что изменение не оказывает негативного влияния на безопасность системы.
*   При внесении изменений в программное обеспечение по индивидуальному заказу все обновления проверяются на соответствие требованиям 6.2.4 перед внедрением в производство.
*   Процедуры устранения сбоев и возврата в безопасное состояние.

Изучите документированные процедуры контроля изменений, чтобы убедиться, что процедуры определены для изменений всех компонентов системы в производственной среде, чтобы включить все элементы, указанные в этом требовании.

Изучите последние изменения в компонентах системы и проследите эти изменения до соответствующей документации по управлению изменениями. Для каждого проверенного изменения убедитесь, что изменение реализовано в соответствии со всеми элементами, указанными в этом требовании.

### 6.5.2   После завершения существенных изменений подтверждается, что все применимые требования PCI DSS применяются ко всем новым или измененным системам и сетям, а документация обновляется по мере необходимости.

Изучите документацию на предмет существенных изменений, опросите персонал и понаблюдайте за затронутыми системами/сетями, чтобы убедиться, что организация подтвердила, что применимые требования PCI DSS применяются ко всем новым или измененным системам и сетям, и что документация была обновлена по мере необходимости.

### 6.5.3   Предпроизводственные среды отделены от производственных сред, и это разделение обеспечивается с помощью средств контроля доступа.

Изучите политики и процедуры, чтобы убедиться, что определены процессы для отделения среды подготовки производства от производственной среды с помощью средств управления доступом, которые обеспечивают разделение.

Изучите сетевую документацию и конфигурации средств управления сетевой безопасностью, чтобы убедиться, что предпроизводственная среда отделена от производственной среды (ов).

Проверьте настройки контроля доступа, чтобы убедиться, что средства контроля доступа установлены для обеспечения разделения между предварительной и производственной средой (средами).

### 6.5.4   Роли и функции разделены между производственной и предпроизводственной средами для обеспечения подотчетности таким образом, чтобы внедрялись только проверенные и утвержденные изменения.

Изучите политики и процедуры, чтобы убедиться, что процессы определены для разделения ролей и функций для обеспечения подотчетности таким образом, чтобы внедрялись только проверенные и одобренные изменения.

Наблюдать за процессами и проводить собеседования с персоналом для проверки внедренных средств контроля, разделения ролей и функций и обеспечения подотчетности таким образом, чтобы внедрялись только проверенные и одобренные изменения.

### 6.5.5   Текущие PANs не используются в предпроизводственных средах, за исключением случаев, когда эти среды включены в CDE и защищены в соответствии со всеми применимыми требованиями PCI DSS.

Изучите политики и процедуры, чтобы убедиться, что процессы определены для отказа от использования live PANs в предпроизводственных средах, за исключением случаев, когда эти среды находятся в CDE и защищены в соответствии со всеми применимыми требованиями PCI DSS.

Наблюдайте за процессами тестирования и опрашивайте персонал, чтобы убедиться в наличии процедур, гарантирующих, что live PANs не используются в предпроизводственных средах, за исключением случаев, когда эти среды находятся в CDE и защищены в соответствии со всеми применимыми требованиями PCI DSS.

Изучите данные предпроизводственных тестов, чтобы убедиться, что live PANs не используются в предпроизводственных средах, за исключением случаев, когда эти среды находятся в CDE и защищены в соответствии со всеми применимыми требованиями PCI DSS.

### 6.5.6   Тестовые данные и тестовые учетные записи удаляются из компонентов системы перед запуском системы в эксплуатацию.

Изучите политики и процедуры, чтобы убедиться, что определены процессы для удаления тестовых данных и тестовых учетных записей из компонентов системы до запуска системы в производство.

Наблюдать за процессами тестирования как готового программного обеспечения, так и собственных приложений, а также проводить собеседования с персоналом для проверки того, что тестовые данные и тестовые учетные записи удаляются до запуска системы в производство.

Изучите данные и учетные записи для недавно установленного или обновленного готового программного обеспечения и собственных приложений, чтобы убедиться в отсутствии тестовых данных или тестовых учетных записей в производственных системах.

