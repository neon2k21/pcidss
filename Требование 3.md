#   Требование 3: Защита Хранимых Данных Учетной Записи

Такие методы защиты, как шифрование, усечение, маскирование и хеширование, являются важнейшими компонентами защиты данных учетной записи. Если злоумышленник обходит другие средства контроля безопасности и получает доступ к зашифрованным данным учетной записи, данные нечитаемы без надлежащих криптографических ключей и непригодны для использования этим злоумышленником. Другие эффективные методы защиты хранимых данных также следует рассматривать в качестве потенциальных возможностей снижения рисков. Например, методы минимизации риска включают в себя отказ от хранения данных учетной записи без необходимости, усечение данных о держателях карт, если не требуется полный PAN, и отказ от отправки незащищенных PAN с использованием технологий обмена сообщениями конечных пользователей, таких как электронная почта и мгновенные сообщения.
Если данные учетной записи присутствуют в непостоянной памяти (например, ОЗУ, энергозависимой памяти), шифрование данных учетной записи не требуется. Однако должны быть установлены надлежащие средства управления, чтобы гарантировать, что память поддерживает непостоянное состояние. Данные должны быть удалены из энергозависимой памяти после завершения бизнес-цели (например, связанной транзакции). В случае, если хранение данных становится постоянным, будут применяться все применимые требования PCI DSS, включая шифрование хранимых данных.
Требование 3 применяется к защите сохраненных данных учетной записи, если это специально не указано в отдельном требовании.

##  3.1 Определены и понятны процессы и механизмы защиты хранимых данных учетной записи.
### 3.1.1 Все политики безопасности и операционные процедуры, указанные в Требовании 3:
*   Задокументированы.
*   Актуальны.
*   Используются.
*   Известны всем затронутым сторонам.

Изучите документацию и опросите персонал, чтобы убедиться, что политика безопасности и операционные процедуры, указанные в Требовании 3, управляются в соответствии со всеми элементами, указанными в этом требовании.

### 3.1.2 Роли и обязанности для выполнения действий, указанных в Требовании 3, задокументированы, распределены и поняты.

Распределяются повседневные обязанности по выполнению всех действий, указанных в Требовании 3. Персонал несет ответственность за успешное и непрерывное выполнение этих требований.

Изучите документацию, чтобы убедиться, что описания ролей и обязанностей, выполняющих действия в Требовании 3, задокументированы и распределены. 

Провести собеседование с персоналом, ответственным за выполнение действий, указанных в Требовании 3, чтобы убедиться, что роли и обязанности распределены в соответствии с документацией и поняты.

## 3.2 Хранение данных учетной записи сведено к минимуму.

### 3.2.1 Хранение данных учетной записи сведено к минимуму благодаря внедрению политик, процедур и процессов хранения и удаления данных, которые включают, по крайней мере, следующее:
*   Охват всех мест хранения данных учетной записи.
*   Покрытие любых конфиденциальных аутентификационных данных (SAD), сохраненных до завершения авторизации. Этот бюллетень является наилучшей практикой до даты его вступления в силу; 
*   Ограничение объема и времени хранения данных до уровня, требуемого в соответствии с правовыми или нормативными и/или бизнес-требованиями.
*   Конкретные требования к хранению хранимых данных учетной записи, которые определяют продолжительность периода хранения и включают документированное бизнес-обоснование.
*   Процессы для безопасного удаления или восстановления данных учетной записи, когда они больше не нужны в соответствии с политикой хранения.
*   Процесс проверки, по крайней мере, **один раз в три месяца**, того, что сохраненные данные учетной записи, превышающие установленный срок хранения, были надежно удалены или восстановлены.

Изучите политики, процедуры и процессы хранения и удаления данных и опросите персонал, чтобы убедиться, что процессы определены так, чтобы включать все элементы, указанные в этом требовании.

Проверьте файлы и системные записи на системных компонентах, где хранятся данные учетной записи, чтобы убедиться, что объем хранения данных и время хранения не превышают требований, определенных в политике хранения данных.

Соблюдайте механизмы, используемые для восстановления данных учетной записи, чтобы убедиться, что данные не могут быть восстановлены.

## 3.3 Конфиденциальные аутентификационные данные (SAD) не сохраняются после авторизации.

### 3.3.1 SAD не сохраняется после авторизации, даже если он зашифрован. Все полученные конфиденциальные аутентификационные данные становятся невосстановимыми после завершения процесса авторизации

Если получен SAD, изучите документированные политики, процедуры и конфигурации системы, чтобы убедиться, что данные не сохраняются после авторизации.

Если получен SAD, изучите документированные процедуры и соблюдайте безопасные процессы удаления данных, чтобы убедиться, что данные становятся невосстановимыми после завершения процесса авторизации.

####    3.3.1.1 Полное содержимое любого трека не сохраняется после завершения процесса авторизации.

Проверьте источники данных, чтобы убедиться, что полное содержимое любого трека не сохраняется после завершения процесса авторизации.

####    3.3.1.2 Код подтверждения карты не сохраняется после завершения процесса авторизации.

Проверьте источники данных, чтобы убедиться, что проверочный код карты не сохраняется после завершения процесса авторизации.

####    3.3.1.3 Личный идентификационный номер (PIN-код) и блок PIN-кода не сохраняются после завершения процесса авторизации.

Проверьте источники данных, чтобы убедиться, что PIN-коды и блоки PIN-кодов не сохраняются после завершения процесса авторизации.

### 3.3.2 Информация, хранящаяся в электронном виде до завершения авторизации, шифруется с использованием надежной криптографии.

Изучите хранилища данных, системные конфигурации и/ или документацию поставщика, чтобы убедиться, что вся информация, хранящаяся в электронном виде до завершения авторизации, зашифрована с использованием надежной криптографии.

### 3.3.3 Дополнительное требование к эмитентам и компаниям, которые поддерживают услуги выдачи и хранят конфиденциальные аутентификационные данные: Любое хранение конфиденциальных аутентификационных данных:
*   Ограничено тем, что необходимо для законных бизнес-потребностей эмитента и защищено.
*   Зашифровано с использованием надежной криптографии. Этот бюллетень является наилучшей практикой до даты его вступления в силу; подробности см. в Примечаниях к применению ниже.

Дополнительная процедура тестирования для эмитентов и компаний, которые поддерживают услуги по выдаче и хранят конфиденциальные аутентификационные данные: Изучите документированные политики и опросите персонал, чтобы убедиться в наличии документированного бизнес-обоснования для хранения конфиденциальных аутентификационных данных.

Дополнительная процедура тестирования для эмитентов и компаний, которые поддерживают услуги выдачи и хранят конфиденциальные аутентификационные данные: Проверьте хранилища данных и системные конфигурации, чтобы убедиться, что конфиденциальные аутентификационные данные хранятся надежно

##  3.4 Доступ к отображению полного PAN и возможность копирования PAN ограничены.
### 3.4.1   При отображении PAN маскируется (ячейка и последние четыре цифры - это максимальное количество отображаемых цифр), так что только персонал с законными деловыми потребностями может видеть больше, чем ячейка и последние четыре цифры PAN.

Изучить документированные политики и процедуры для маскировки отображения лотков для проверки:
*   Задокументирован список ролей, которым требуется доступ не только к BIN и последним четырем цифрам PAN (включая полный PAN), а также законная бизнес-потребность в том, чтобы каждая роль имела такой доступ.
*   При отображении PAN маскируется таким образом, что только персонал, имеющий законную деловую потребность, может видеть больше, чем ячейку и последние четыре цифры PAN.
Все роли, не имеющие специального разрешения на просмотр полного PAN, должны видеть только замаскированный PAN.

Проверьте системные конфигурации, чтобы убедиться, что полный PAN отображается только для ролей с документированной бизнес-потребностью, и что PAN скрыт для всех других запросов.

Изучите отображение PAN (например, на экране, на бумажных квитанциях), чтобы убедиться, что PAN маскируются при отображении и что только те, у кого есть законные деловые потребности, могут видеть больше, чем ячейка и / или последние четыре цифры PAN.

### 3.4.2   При использовании технологий удаленного доступа технические средства контроля предотвращают копирование и/или перемещение PAN для всего персонала, за исключением тех, у кого есть документально подтвержденное, четкое разрешение и законная, определенная деловая потребность.

Изучить документированные политики и процедуры и документированные доказательства технических средств контроля, которые предотвращают копирование и/или перемещение PAN при использовании технологий удаленного доступа на локальные жесткие диски или съемные электронные носители, чтобы убедиться в следующем:
*   Технические средства контроля запрещают любому персоналу, не имеющему специального разрешения, копировать и/или перемещать PAN.
*   Ведется список персонала, имеющего разрешение на копирование и/или перемещение PAN, вместе с документированным, четким разрешением и законными, определенными бизнес-потребностями.

Изучите конфигурации для технологий удаленного доступа, чтобы убедиться, что технические средства контроля предотвращают копирование и/или перемещение PAN для всего персонала, если это явно не разрешено.

Наблюдайте за процессами и проводите собеседования с персоналом, чтобы убедиться, что только персонал с документированным, четким разрешением и законной, определенной бизнес-потребностью имеет разрешение на копирование и/или перемещение PAN при использовании технологий удаленного доступа.

## 3.5 Основной номер счета (PAN) защищен, где бы он ни хранился.
### 3.5.1 PAN становится нечитаемым в любом месте, где хранится, с использованием любого из следующих подходов:
*   Односторонние хэши, основанные на надежной криптографии всего PAN.
*   Усечение (хэширование не может быть использовано для замены усеченного сегмента PAN).
*   Если в среде присутствуют хэшированные и усеченные версии одного и того же PAN или разные форматы усечения одного и того же PAN, применяются дополнительные средства управления, позволяющие не сопоставлять разные версии для восстановления исходного PAN.
*   Индексные токены.
*   Надежная криптография с соответствующими процессами и процедурами управления ключами.

Изучите документацию о системе, используемой для обеспечения нечитаемости PAN, включая поставщика, тип системы/процесса и алгоритмы шифрования (если применимо), чтобы убедиться, что PAN становится нечитаемым с использованием любого из методов, указанных в этом требовании.

Проверьте хранилища данных и журналы аудита, включая журналы платежных приложений, чтобы убедиться, что PAN становится нечитаемым с использованием любого из методов, указанных в этом требовании.

Если в среде присутствуют хэшированные и усеченные версии одного и того же PAN, проверьте реализованные элементы управления, чтобы убедиться, что хэшированные и усеченные версии не могут быть сопоставлены для восстановления исходного PAN.

####    3.5.1.1 Хэши, используемые для того, чтобы сделать PAN нечитаемым (согласно первому пункту Требования 3.5.1), представляют собой криптографические хэши с ключом для всего PAN, с соответствующими процессами и процедурами управления ключами в соответствии с требованиями 3.6 и 3.7.

Изучите документацию о методе хеширования, используемом для того, чтобы сделать PAN нечитаемым, включая поставщика, тип системы/процесса и алгоритмы шифрования (если применимо), чтобы убедиться, что метод хеширования приводит к криптографическим хэшам с ключом для всего PAN, с соответствующими процессами и процедурами управления ключами.

Изучите документацию о процедурах управления ключами и процессах, связанных с криптографическими хэшами с ключами, чтобы убедиться, что управление ключами осуществляется в соответствии с требованиями 3.6 и 3.7.

Проверьте хранилища данных, чтобы убедиться, что PAN становится нечитаемым.

Изучите журналы аудита, включая журналы платежных приложений, чтобы убедиться, что PAN становится нечитаемым.

####    3.5.1.2 Если шифрование на уровне диска или раздела (а не шифрование базы данных на уровне файлов, столбцов или полей) используется для того, чтобы сделать PAN нечитаемым, оно реализуется только следующим образом:
*   На съемных электронных носителях, ИЛИ
*   При использовании для несъемных электронных носителей PAN также становится нечитаемым с помощью другого механизма, который соответствует требованию 3.5.1.

Изучите процессы шифрования, чтобы убедиться, что, если шифрование на уровне диска или раздела используется для того, чтобы сделать PAN нечитаемым, оно реализуется только следующим образом:
*   На съемных электронных носителях ИЛИ
*   Если используется для несъемных электронных носителей, изучите процессы шифрования, используемые для проверки того, что PAN также становится нечитаемым с помощью другого метода, который соответствует требованию 3.5.1.

Изучите конфигурации и/или документацию поставщика и соблюдайте процессы шифрования, чтобы убедиться, что система настроена в соответствии с документацией поставщика. Результатом является то, что диск или раздел становятся нечитаемыми.

####    3.5.1.3 Если используется шифрование на уровне диска или раздела (а не шифрование базы данных на уровне файлов, столбцов или полей), чтобы сделать PAN нечитаемым, оно управляется следующим образом:
*   Логический доступ управляется отдельно и независимо от собственных механизмов аутентификации и контроля доступа операционной системы.
*   Ключи дешифрования не связаны с учетными записями пользователей.
*   Факторы аутентификации (пароли, кодовые фразы или криптографические ключи), которые позволяют получить доступ к незашифрованным данным, хранятся надежно

Если для того, чтобы сделать PAN нечитаемым, используется шифрование на уровне диска или раздела, проверьте конфигурацию системы и проследите за процессом аутентификации, чтобы убедиться, что логический доступ реализован в соответствии со всеми элементами, указанными в этом требовании.

Изучите файлы, содержащие факторы аутентификации (пароли, кодовые фразы или криптографические ключи), и опросите персонал, чтобы убедиться, что факторы аутентификации, позволяющие получить доступ к незашифрованным данным, хранятся надежно и не зависят от методов аутентификации и контроля доступа собственной операционной системы.

## 3.6 Защищены криптографические ключи, используемые для защиты сохраненных данных учетной записи.
### 3.6.1 Определены и реализованы процедуры защиты криптографических ключей, используемых для защиты сохраненных данных учетной записи от разглашения и неправильного использования, которые включают: 
*   Доступ к ключам ограничен минимальным количеством необходимых хранителей.
*   Ключи шифрования ключей, по крайней мере, столь же надежны, как и ключи шифрования данных, которые они защищают.
*   Ключи шифрования ключей хранятся отдельно от ключей шифрования данных.
*   Ключи надежно хранятся в минимально возможном количестве мест и форм.

Изучите документированные политики и процедуры управления ключами, чтобы убедиться, что процессы защиты криптографических ключей, используемых для защиты хранимых данных учетной записи от разглашения и неправильного использования, определены так, чтобы включать все элементы, указанные в этом требовании.

####    3.6.1.1 Дополнительное требование только для поставщиков услуг: Поддерживается документированное описание криптографической архитектуры, которое включает:
*   Подробная информация обо всех алгоритмах, протоколах и ключах, используемых для защиты сохраненных данных учетной записи, включая надежность ключа и дату истечения срока действия.
*   Предотвращение использования одних и тех же криптографических ключей в рабочей и тестовой средах. Этот бюллетень является наилучшей практикой до даты его вступления в силу;
*   Описание использования ключа для каждого ключа.
*   Инвентаризация любых аппаратных модулей безопасности (HSM), систем управления ключами (KMS) и других защищенных криптографических устройств (SCDS), используемых для управления ключами, включая тип и местоположение устройств, как указано в требовании 12.3.4.

Дополнительная процедура тестирования только для оценки поставщика услуг: Опросите ответственный персонал и изучите документацию, чтобы убедиться, что существует документ, описывающий криптографическую архитектуру, которая включает все элементы, указанные в этом требовании.

####    3.6.1.2 Секретные и закрытые ключи, используемые для шифрования/дешифрования сохраненных данных учетной записи, постоянно хранятся в одной (или нескольких) из следующих форм:
*   Зашифровано с помощью ключа шифрования ключа, который, по крайней мере, такой же надежный, как ключ шифрования данных, и который хранится отдельно от ключа шифрования данных.
*   В защищенном криптографическом устройстве (SCD), таком как аппаратный модуль безопасности (HSM) или устройство точки взаимодействия, одобренное PTS.
*   Как минимум два полноразмерных ключевых компонента или ключевых элемента в соответствии с принятым в отрасли методом.

Изучить документированные процедуры для проверки того, определено ли, что криптографические ключи, используемые для шифрования/дешифрования сохраненных данных учетной записи, должны существовать только в одной (или более) из форм, указанных в этом требовании.

Изучите системные конфигурации и места хранения ключей, чтобы убедиться, что криптографические ключи, используемые для шифрования/дешифрования сохраненных данных учетной записи, существуют в одной (или нескольких) формах, указанных в этом требовании.

Везде, где используются ключи шифрования ключей, изучите системные конфигурации и места хранения ключей, чтобы убедиться: 
*   Ключи шифрования ключей, по крайней мере, такие же надежные, как ключи шифрования данных, которые они защищают. 
*   Ключи шифрования ключей хранятся отдельно от ключей шифрования данных.

####    3.6.1.3 Доступ к компонентам криптографических ключей с открытым текстом ограничен минимальным количеством необходимых хранителей.

Изучите списки доступа пользователей, чтобы убедиться, что доступ к компонентам криптографических ключей открытого текста ограничен наименьшим количеством необходимых хранителей.

####    3.6.1.4 Криптографические ключи хранятся в минимально возможном количестве мест.

Проверяйте места хранения ключей и наблюдайте за процессами, чтобы убедиться, что ключи хранятся в наименьшем количестве возможных мест.

##  3.7 В тех случаях, когда для защиты хранимых данных учетной записи используется криптография, определяются и внедряются процессы и процедуры управления ключами, охватывающие все аспекты жизненного цикла ключа.

### 3.7.1   Политики и процедуры управления ключами реализованы таким образом, чтобы включать генерацию надежных криптографических ключей, используемых для защиты хранимых данных учетной записи.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты хранимых данных учетной записи, чтобы убедиться, что они определяют генерацию надежных криптографических ключей.

Соблюдайте метод генерации ключей, чтобы убедиться, что сгенерированы надежные ключи.

### 3.7.2   Политики и процедуры управления ключами реализованы таким образом, чтобы включать безопасное распространение криптографических ключей, используемых для защиты хранимых данных учетной записи.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты хранимых данных учетной записи, чтобы убедиться, что они определяют безопасное распределение криптографических ключей.

Соблюдайте метод распределения ключей, чтобы убедиться в том, что ключи распределяются надежно.

### 3.7.3 Политики и процедуры управления ключами реализованы таким образом, чтобы включать безопасное хранение криптографических ключей, используемых для защиты хранимых данных учетной записи.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты хранимых данных учетной записи, чтобы убедиться, что они определяют безопасное хранение криптографических ключей.

Соблюдайте метод хранения ключей, чтобы убедиться, что ключи хранятся надежно.

### 3.7.4 Политики и процедуры управления ключами применяются для изменений криптографических ключей для ключей, срок действия которых истек, в соответствии с определением соответствующего поставщика приложений или владельца ключа и на основе лучших отраслевых практик и рекомендаций, включая следующее:
*   Определенный криптопериод для каждого используемого типа ключа.
*   Процесс изменения ключа в конце определенного криптопериода.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты хранимых данных учетной записи, чтобы убедиться, что они определяют изменения в криптографических ключах, срок действия которых истек, и включают все элементы, указанные в этом требовании.

Опрашивайте персонал, изучайте документацию и наблюдайте за местами хранения ключей, чтобы убедиться, что ключи меняются в конце определенного криптопериода (ов).

### 3.7.5   Применяются процедуры политики управления ключами, включающие удаление, замену или уничтожение ключей, используемых для защиты сохраненных данных учетной записи, по мере необходимости, когда:
*   Ключ достиг конца своего определенного криптопериода.
*   Целостность ключа была ослаблена, в том числе, когда персонал, знающий о ключевом компоненте открытого текста, покидает компанию или роль, для которой был известен ключевой компонент.
*   Подозревается или известно, что ключ скомпрометирован. Удаленные или замененные ключи не используются для операций шифрования.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты сохраненных данных учетной записи, и убедитесь, что они определяют удаление, замену или уничтожение ключей в соответствии со всеми элементами, указанными в этом требовании.

Провести собеседование с персоналом, чтобы убедиться, что процессы выполняются в соответствии со всеми элементами, указанными в этом требовании.

### 3.7.6 Там, где персонал выполняет операции по управлению ключами с открытым текстом вручную, политики и процедуры управления ключами включают управление этими операциями с использованием разделенных знаний и двойного контроля.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты хранимых данных учетной записи, и убедитесь, что они определены с использованием разделенных знаний и двойного контроля.

Опрашивать персонал и / или наблюдать за процессами, чтобы убедиться, что ручные ключи открытого текста управляются с разделенными знаниями и двойным контролем.

### 3.7.7   Политики и процедуры управления ключами реализованы таким образом, чтобы включать предотвращение несанкционированной замены криптографических ключей.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты хранимых данных учетной записи, и убедитесь, что они определяют предотвращение несанкционированной замены криптографических ключей.

Опрашивать персонал и/или наблюдать за процессами, чтобы убедиться, что предотвращена несанкционированная замена ключей.

### 3.7.8   Политики и процедуры управления ключами внедрены таким образом, чтобы ответственные за хранение криптографических ключей официально подтверждали (в письменной или электронной форме), что они понимают и принимают свои обязанности по хранению ключей.

Изучите документированные политики и процедуры управления ключами для ключей, используемых для защиты хранимых данных учетной записи, и убедитесь, что они определяют подтверждения для хранителей ключей в соответствии со всеми элементами, указанными в этом требовании.

Изучите документацию или другие доказательства, свидетельствующие о том, что хранители ключей предоставили подтверждения в соответствии со всеми элементами, указанными в этом требовании.

### 3.7.9   Дополнительное требование только для поставщиков услуг: Если поставщик услуг делится криптографическими ключами со своими клиентами для передачи или хранения данных учетной записи, руководство по безопасной передаче, хранению и обновлению таких ключей документируется и распространяется среди клиентов поставщика услуг.

